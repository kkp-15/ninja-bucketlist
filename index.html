<!DOCTYPE html><html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>タイムバケットリスト</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>タイムバケットでやりたいことを整理！</h1>  <form id="addForm">
    <input type="text" id="title" placeholder="やりたいこと" required>
    <input type="number" id="age" placeholder="達成したい年齢">
    <input type="text" id="category" placeholder="ジャンル">
    <textarea id="memo" placeholder="メモ（任意）"></textarea>
    <button type="submit">追加</button>
  </form>  <div id="list"></div>  <footer>
    <p><a href="https://twitter.com/kkp_webninja" target="_blank">@kkp_webninja をフォロー</a></p>
  </footer>  <script>
    const form = document.getElementById('addForm');
    const listContainer = document.getElementById('list');
    let bucketData = JSON.parse(localStorage.getItem('bucketData') || '[]');

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const title = document.getElementById('title').value.trim();
      const age = document.getElementById('age').value.trim();
      const category = document.getElementById('category').value.trim();
      const memo = document.getElementById('memo').value.trim();
      if (!title) return;
      bucketData.push({ title, age, category, memo, done: false });
      localStorage.setItem('bucketData', JSON.stringify(bucketData));
      form.reset();
      renderList();
    });

    function renderList() {
      listContainer.innerHTML = '';
      const grouped = {};
      bucketData.forEach((item, index) => {
        const decade = item.age ? Math.floor(item.age / 10) * 10 : '未分類';
        if (!grouped[decade]) grouped[decade] = [];
        grouped[decade].push({ item, index });
      });
      const sortedKeys = Object.keys(grouped).sort((a, b) => a === '未分類' ? 1 : b === '未分類' ? -1 : a - b);
      sortedKeys.forEach(decade => {
        const section = document.createElement('details');
        section.open = true;
        section.innerHTML = `<summary>${decade}代（${grouped[decade].length}件）</summary>`;
        grouped[decade].forEach(({ item, index }) => {
          const div = document.createElement('div');
          div.className = 'item' + (item.done ? ' done' : '');
          div.innerHTML = `
            <strong>${item.title}</strong><br>
            ${item.category ? `ジャンル：${item.category}<br>` : ''}
            ${item.age ? `予定年齢：${item.age}歳<br>` : ''}
            ${item.memo ? `メモ：${item.memo}<br>` : ''}
            <button onclick="toggleDone(${index})">${item.done ? '未達成に戻す' : '✅ 達成'}</button>
            <button onclick="editItem(${index})">🖋 編集</button>
            <button onclick="deleteItem(${index})">🗑 削除</button>
          `;
          section.appendChild(div);
        });
        listContainer.appendChild(section);
      });
    }

    function toggleDone(index) {
      bucketData[index].done = !bucketData[index].done;
      localStorage.setItem('bucketData', JSON.stringify(bucketData));
      renderList();
    }

    function deleteItem(index) {
      if (confirm('削除してもよいですか？')) {
        bucketData.splice(index, 1);
        localStorage.setItem('bucketData', JSON.stringify(bucketData));
        renderList();
      }
    }

    function editItem(index) {
      const item = bucketData[index];
      const newTitle = prompt('やりたいことを修正', item.title);
      if (newTitle !== null) item.title = newTitle;
      const newAge = prompt('達成したい年齢を修正', item.age);
      if (newAge !== null) item.age = newAge;
      const newCategory = prompt('ジャンルを修正', item.category);
      if (newCategory !== null) item.category = newCategory;
      const newMemo = prompt('メモを修正', item.memo);
      if (newMemo !== null) item.memo = newMemo;
      localStorage.setItem('bucketData', JSON.stringify(bucketData));
      renderList();
    }

    renderList();
  </script></body>
</html>
